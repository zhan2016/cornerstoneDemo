<!DOCTYPE HTML>
<html>
<head>
  <!-- Support for mobile touch devices -->
  <meta charset="utf-8" name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimal-ui">

  <!-- CSS -->

  <!-- Font awesome CSS for tool icons -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <!-- Bootstrap CSS -->
  <link href="lib/bootstrap.min.css" rel="stylesheet">

  <!-- datarangerpicker CSS -->
  <link href="lib/daterangepicker.css" rel="stylesheet">
  <!-- UI CSS -->
  <link href="lib/jquery-ui.min.css" rel="stylesheet">  

  <!-- Cornerstone Base CSS -->
  <link href="lib/cornerstone.min.css" rel="stylesheet">

  <!-- Cornerstone Demo CSS -->
  <link href="css/cornerstoneDemo.css" rel="stylesheet">
  <style type="text/css">
    .querylist {
      position:relative;
      top:10px;
      left:50px;
    }
  </style>


</head>

<body>
  <div id="wrap">

    <!-- Nav bar -->
    <nav class="myNav navbar navbar-default" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="http://www.medvision.com.cn/cn/solutions.asp?nid=12&s=1">天健影像诊断系统</a>
        </div>
        <ul class="nav navbar-nav navbar-right">
          <li><a id="help" href="#" class="button hidden-xs">软件使用帮助</a></li>
          <li><a id="about" href="#" class="button hidden-xs">关于</a></li>
        </ul>
      </div>
    </nav>

    <div class='main'>

      <!-- Tabs bar -->
      <ul id="tabs" class="nav nav-tabs" >
        <li class="active"><a href="#studyList" data-toggle="tab">Study List</a></li>
      </ul>

      <!-- Tab content -->
      <div id="tabContent" class="tab-content">
        <!-- Study list -->
        <div id="studyList" class="tab-pane active">
          <div class="querylist">
            <form  role="form" ID="RequestForm">
              <div class="form-group">
                <label class="label-default" for="ID">病人ID</label>
                <input type="text" name="ID" class="form-inline" id="ID" placeholder="请输入ID">
                <label class="label-default" for="ImageID">影像号码</label>
                <input type="text" name="ImageID" class="form-inline" id="ImageID" placeholder="请输入影像号码">
              </div>
              <div class="form-group">
                <label class="label-default" for="name">病人姓名</label>
                <input type="text" class="form-inline" name="patientName" id="name" placeholder="请输入姓名">
                <label class="label-default" for="CheckNum">检查号码</label>
                <input type="text" class="form-inline" name="CheckNum" id="CheckNum" placeholder="请输入检查号码">
                <label class="label-default" for="dataPick">检查日期</label>
                <input type="text" class="form-inline" name="dataPick"id="dataPick" placeholder="时间范围">
              </div>
              <div class="form-group">
              <div class="checkbox-inline">
                <label>
                  <input type="checkbox" name="CR">CR
                </label>
              </div>
              <div class="checkbox-inline">
                <label>
                  <input type="checkbox" name="MR">MR
                </label>
              </div>
              <div class="checkbox-inline">
                <label>
                  <input type="checkbox" name="CT">CT
                </label>
              </div>
              <div class="checkbox-inline">
                <label>
                  <input type="checkbox" name="DX">DX
                </label>
              </div>
              <div class="checkbox-inline">
                <label>
                  <input type="checkbox" name="US">US
                </label>
              </div>
                </div>
              <button type="button" id= "Submit"class="btn btn-default">查询</button>
            </form>
          </div>
          <div class="row">
            <table  class="col-md-12 table table-striped">
              <thead>
                <tr>
                  <th>Patient Name</th>
                  <th>Patient ID</th>
                  <th>Study Date</th>
                  <th>Modality</th>
                  <th>StudyId</th>
                  <th># Images</th>
                </tr>
              </thead>
              
              <tbody id="studyListData">
                <!-- Table rows get populated from the JSON studyList manifest -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Study viewer tab content template -->
  </div>
</div>







<!-- Javascripts -->

<!-- Include JQuery -->
<script src="lib/jquery.min.js"></script>

<!-- Include JQuery UI for drag/drop -->
<script src="lib/jquery-ui.min.js"></script>

<!-- Include JQuery Hammerjs adapter for mobile touch-->
<script src="lib/hammer.min.js"></script>

<!-- Include Bootstrap js -->
<script src="lib/bootstrap.min.js"></script>
<!-- Include moment js -->
  <script src="lib/moment.min.js"></script>
  <!-- include datarangepicker js -->
  <script src="lib/daterangepicker.js" charset="gbk"></script>
<!-- include the cornerstone library -->
<script src="lib/cornerstone.js"></script>

<!-- include the cornerstone library -->
<script src="lib/cornerstoneMath.js"></script>

<!-- include the cornerstone tools library -->
<script src="lib/cornerstoneTools.js"></script>

<!-- include the cornerstoneWADOImageLoader library -->
<script src="lib/cornerstoneWADOImageLoader.js"></script>

<!-- include the cornerstoneWebImageLoader library -->
<script src="lib/cornerstoneWebImageLoader.js"></script>

<!-- include the dicomParser library -->
<script src="lib/dicomParser.js"></script>

  <!-- include the jeson to xml library -->
  <!--<script src="lib/xml2json.min.js"></script>-->
<!-- include the jeson to xml library -->
  <script src="lib/jstoxml.js"></script>
<!-- include cornerstoneDemo.js -->
<script src="js/setupViewport.js"></script>
<script src="js/displayThumbnail.js"></script>
<script src="js/loadStudy.js"></script>
<script src="js/setupButtons.js"></script>
<script src="js/disableAllTools.js"></script>
<script src="js/forEachViewport.js"></script>
<script src="js/imageViewer.js"></script>
<script src="js/loadTemplate.js"></script>
<script src="js/help.js"></script>
<script src="js/about.js"></script>
<script src="js/setupViewportOverlays.js"></script>
<script src="js/cornerstoneDemo.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {

      $('input[name="dataPick"]').daterangepicker(
              {

                format: 'YYYY/MM/DD',
                startDate:new Date(),
                endDate: new Date(),
                maxDate:new Date(),
                locale:{
                  "format":'YYYY/MM/DD',
                  "applyLabel": '确认',
                  "cancelLabel": '取消',
                  "fromLabel": 'From',
                  "toLabel": 'to',
                  weekLabel: 'W',
                  customRangeLabel: '选择时间',
                  daysOfWeek:["日","一","二","三","四","五","六"],
                  monthNames: ["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],
                },
                ranges: {
                  "今天": [new Date(),new Date()],
                  "昨天":[new Date((new Date()).valueOf() - 1000*3600*24), new Date((new Date()).valueOf() - 1000*3600*24)],
                  "过去七天":[new Date((new Date()).valueOf() - 1000*3600*24*7), new Date()]
                }
              },
              function(start, end, label) {
                //alert('A date range was chosen: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
              }
      );
    });
    /*$("#RequestForm").submit(function() {
      var formjson = JSON.stringify($('#RequestForm').serializeArray());
      event.preventDefault();
      $.ajax({
        url: 'http://localhost:7999/',
        processData: false,
        contentType:"text/plain",
        type: "POST",  // type should be POST
        data: formjson, // send the string directly
        dataType:"text/plain",
        success: function(response){

          alert("success");
        },
        error: function (jqXHR, exception) {
          var msg = '';
          if (jqXHR.status === 0) {
            msg = 'Not connect.\n Verify Network.';
          } else if (jqXHR.status == 404) {
            msg = 'Requested page not found. [404]';
          } else if (jqXHR.status == 500) {
            msg = 'Internal Server Error [500].';
          } else if (exception === 'parsererror') {
            msg = 'Requested JSON parse failed.';
          } else if (exception === 'timeout') {
            msg = 'Time out error.';
          } else if (exception === 'abort') {
            msg = 'Ajax request aborted.';
          } else {
            msg = 'Uncaught Error.\n' + jqXHR.responseText;
          }
          alert(msg);
          //$('#post').html(msg);
        },
      });
      return false;
      /*
      // We bind the FormData object and the form element
      var FD  = new FormData(RequestForm);
      var formjson = JSON.stringify($('#RequestForm').serializeArray());
      var jstoxml = new
      var formxml = toXML(formjson,{header: false, indent: '  '});
       var xmlhttp = new XMLHttpRequest();

      xmlhttp.open("POST","http://localhost:7999/",true);
      xmlhttp.setRequestHeader('Content-type', 'text/xml');
      xmlhttp.send(FD);
      return false;

    });*/

    $("#Submit").click(function(e) {
      var formjson = JSON.stringify($('#RequestForm').serializeArray());
      e.preventDefault();
      $.ajax({
        url: 'http://192.168.7.98:7999/',
        processData: false,
        contentType:"text/plain",
        type: "POST",  // type should be POST
        data: formjson, // send the string directly
        //dataType:"text/plain",
        success: function(response){
          //alert(response);
          ShowStudyList(response);
          //alert("success");
        },
        error: function (jqXHR, exception) {
          var msg = '';
          if (jqXHR.status === 0) {
            msg = 'Not connect.\n Verify Network.';
          } else if (jqXHR.status == 404) {
            msg = 'Requested page not found. [404]';
          } else if (jqXHR.status == 500) {
            msg = 'Internal Server Error [500].';
          } else if (exception === 'parsererror') {
            msg = 'Requested JSON parse failed.';
          } else if (exception === 'timeout') {
            msg = 'Time out error.';
          } else if (exception === 'abort') {
            msg = 'Ajax request aborted.';
          } else {
            msg = 'Uncaught Error.\n' + jqXHR.responseText;
          }
          alert(msg);
          //$('#post').html(msg);
        },
      });
      return false;
    });




  </script>

</body>
</html>